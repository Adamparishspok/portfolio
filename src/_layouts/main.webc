<!DOCTYPE html>
<html lang="en" class="scroll-smooth" color-scheme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="canonical" :href="base.url + page.url" />

    <!--- Search + Tab --->
    <title @html="this.seoTitle"></title>
    <meta name="description" :content="this.seoDesc" />

    <!--- OpenGraph --->
    <meta property="og:site_name" :content="base.name" />
    <meta property="og:type" content="website" />
    <meta property="og:title" :content="this.ogTitle" />
    <meta property="og:description" :content="this.ogDesc" />
    <meta property="og:url" :content="base.url + page.url" />
    <meta property="og:image" :content="base.url + this.ogImage" />
    <meta property="og:image:alt" :content="this.ogImageAlt" />

    <!--- Twitter --->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" :content="base.twitterHandle" />
    <meta name="twitter:creator" :content="base.twitterHandle" />

    <!--- Prevent Indexing --->
    <meta webc:if="this.noindex" name="robots" content="noindex, nofollow" />

    <!--- Light/Dark Mode: Set initially --->
    <script webc:keep>
      (function () {
        const scheme =
          localStorage.getItem('scheme') ||
          (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        if (scheme === 'dark') {
          document.documentElement.setAttribute('color-scheme', 'dark');
        } else {
          document.documentElement.setAttribute('color-scheme', 'light');
        }
        document.documentElement.style.visibility = 'hidden';
        window.addEventListener('DOMContentLoaded', function () {
          document.documentElement.style.visibility = '';
        });
      })();
    </script>
    <!--- Light/Dark Mode: Toggling --->
    <script>
      const toggleSchemes = document.querySelectorAll('[data-toggle-scheme-checkbox]');
      const scheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';

      function darkMode() {
        document.body.classList.add('no-transition');
        setTimeout(() => {
          document.body.classList.remove('no-transition');
        }, 100);
        document.documentElement.setAttribute('color-scheme', 'dark');
        toggleSchemes.forEach((toggleScheme) => {
          toggleScheme.checked = true;
        });
      }

      function lightMode() {
        document.body.classList.add('no-transition');
        setTimeout(() => {
          document.body.classList.remove('no-transition');
        }, 100);
        document.documentElement.setAttribute('color-scheme', 'light');
        toggleSchemes.forEach((toggleScheme) => {
          toggleScheme.checked = false;
        });
      }

      function userMode() {
        document.body.classList.add('no-transition');
        setTimeout(() => {
          document.body.classList.remove('no-transition');
        }, 100);
        if (scheme === 'dark') {
          darkMode();
        } else {
          lightMode();
        }
      }

      function setScheme() {
        if (localStorage.scheme === 'dark') {
          darkMode();
        } else if (localStorage.scheme === 'light') {
          lightMode();
        } else {
          userMode();
        }
      }
      setScheme();

      function updateScheme(event) {
        if (event.target.checked === true) {
          localStorage.setItem('scheme', 'dark');
          darkMode();
        } else {
          localStorage.setItem('scheme', 'light');
          lightMode();
        }
      }

      toggleSchemes.forEach((toggleScheme) => {
        toggleScheme.addEventListener('change', function (event) {
          updateScheme(event);
        });
      });
    </script>

    <!--- Fonts --->
    <style>
      :root {
        font-family:
          'Geist Sans', 'ui-sans-serif', 'system-ui', 'sans-serif', 'Apple Color Emoji',
          'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
        font-weight: 400;
        -webkit-font-smoothing: antialiased;
      }
    </style>

    <!--- Styles --->
    <link rel="stylesheet" href="/assets/css/main.css" webc:keep />
    <link webc:if="markdown" rel="stylesheet" href="/assets/css/markdown.css" webc:keep />
    <style @raw="getBundle('css')" webc:keep></style>

    <!--- Icons --->
    <link rel="icon" type="image/png" href="/assets/images/favicon/icon-96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/assets/images/favicon/favicon.svg" />
    <link rel="shortcut icon" href="/assets/images/favicon/favicon.ico" />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/assets/images/favicon/apple-touch-icon.png"
    />
    <link rel="manifest" href="/manifest.webmanifest" />

    <!--- PostHog --->
    <script>
      !(function (t, e) {
        var o, n, p, r;
        e.__SV ||
          ((window.posthog = e),
          (e._i = []),
          (e.init = function (i, s, a) {
            function g(t, e) {
              var o = e.split('.');
              (2 == o.length && ((t = t[o[0]]), (e = o[1])),
                (t[e] = function () {
                  t.push([e].concat(Array.prototype.slice.call(arguments, 0)));
                }));
            }
            (((p = t.createElement('script')).type = 'text/javascript'),
              (p.crossOrigin = 'anonymous'),
              (p.async = !0),
              (p.src =
                s.api_host.replace('.i.posthog.com', '-assets.i.posthog.com') + '/static/array.js'),
              (r = t.getElementsByTagName('script')[0]).parentNode.insertBefore(p, r));
            var u = e;
            for (
              void 0 !== a ? (u = e[a] = []) : (a = 'posthog'),
                u.people = u.people || [],
                u.toString = function (t) {
                  var e = 'posthog';
                  return ('posthog' !== a && (e += '.' + a), t || (e += ' (stub)'), e);
                },
                u.people.toString = function () {
                  return u.toString(1) + '.people (stub)';
                },
                o =
                  'init capture register register_once register_for_session unregister unregister_for_session getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on sessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey getNextSurveyStep identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty createPersonProfile opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing debug'.split(
                    ' '
                  ),
                n = 0;
              n < o.length;
              n++
            )
              g(u, o[n]);
            e._i.push([i, s, a]);
          }),
          (e.__SV = 1));
      })(document, window.posthog || []);
      posthog.init('phc_PVCwdgCGgAV76xJR6eA2DxTEwiqejQpFaUyz4oo8ltz', {
        api_host: 'https://us.i.posthog.com',
        person_profiles: 'identified_only',
      });
    </script>

    <script async webc:keep src="https://www.googletagmanager.com/gtag/js?id=G-3BCTP3WC02"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());

      gtag('config', 'G-3BCTP3WC02');
    </script>
  </head>

  <body
    class="flex min-h-screen flex-col text-zinc-400 antialiased selection:bg-zinc-800 selection:text-zinc-100"
  >
    <!--- Page Transition Overlay --->
    <div id="page-transition" class="fixed inset-0 z-40 bg-black pointer-events-none opacity-0 transition-opacity duration-500"></div>

    <!--- Content --->
    <div
      id="main-content"
      @html="this.content"
    ></div>

    <script webc:keep src="/assets/js/InertiaPlugin.min.js"></script>
    <script @raw="getBundle('js')" webc:keep>
      gsap.registerPlugin(InertiaPlugin);
    </script>
    <!-- GSAP Core and Plugins for Page Transitions -->
    <script webc:keep src="/assets/js/gsap.min.js"></script>
    <script webc:keep src="/assets/js/ScrollTrigger.min.js"></script>
    <script @raw="getBundle('js')" webc:keep>
      gsap.registerPlugin(ScrollTrigger, InertiaPlugin);
    </script>
    <!-- UnicornStudio Background Script -->
    <script webc:raw type="text/javascript">
      !(function () {
        if (!window.UnicornStudio) {
          window.UnicornStudio = { isInitialized: !1 };
          var i = document.createElement('script');
          ((i.src =
            'https://cdn.jsdelivr.net/gh/hiunicornstudio/unicornstudio.js@v1.4.29/dist/unicornStudio.umd.js'),
            (i.onload = function () {
              window.UnicornStudio.isInitialized ||
                (UnicornStudio.init(), (window.UnicornStudio.isInitialized = !0));
            }),
            (document.head || document.body).appendChild(i));
        }
      })();
    </script>

    <!-- Lucide Icons -->

    <!-- Page Transition Scripts -->
    <script webc:raw type="text/javascript">
      // Page Transition System
      class PageTransition {
        constructor() {
          this.transition = document.getElementById('page-transition');
          this.mainContent = document.getElementById('main-content');
          this.isTransitioning = false;

          this.init();
        }

        init() {
          // Handle initial page load
          this.handleInitialLoad();

          // Handle navigation clicks
          this.handleNavigation();

          // Handle browser back/forward
          this.handleBrowserNavigation();
        }

        handleInitialLoad() {
          // Show content immediately on page load
          window.addEventListener('load', () => {
            this.showContent();
          });
        }

        showContent() {
          if (this.mainContent) {
            // Animate content elements with stagger
            this.animateContentElements();
          }
        }

        animateContentElements() {
          // Animate headers, paragraphs, and other content elements
          const elements = this.mainContent.querySelectorAll('h1, h2, h3, p, .card, .project-card');
          gsap.fromTo(
            elements,
            {
              opacity: 0,
              y: 20,
            },
            {
              opacity: 1,
              y: 0,
              duration: 0.6,
              stagger: 0.1,
              ease: 'power2.out',
              delay: 0.3,
            }
          );
        }

        handleNavigation() {
          // Intercept all internal links
          document.addEventListener('click', (e) => {
            const link = e.target.closest('a[href]');
            if (!link) return;

            const href = link.getAttribute('href');

            // Check if it's an internal link (not external, not hash, not mailto/tel)
            if (
              href &&
              !href.startsWith('http') &&
              !href.startsWith('#') &&
              !href.startsWith('mailto:') &&
              !href.startsWith('tel:') &&
              !link.hasAttribute('download')
            ) {
              e.preventDefault();
              this.navigateTo(href);
            }
          });
        }

        handleBrowserNavigation() {
          // Handle browser back/forward buttons
          window.addEventListener('popstate', (e) => {
            if (e.state && e.state.url) {
              this.navigateTo(e.state.url, false);
            }
          });
        }

        async navigateTo(url, addToHistory = true) {
          if (this.isTransitioning) return;
          this.isTransitioning = true;

          try {
            // Show transition overlay
            this.showTransition();

            // Fetch new page content
            const response = await fetch(url);
            const html = await response.text();

            // Parse the HTML to get just the content area
            const parser = new DOMParser();
            const newDoc = parser.parseFromString(html, 'text/html');
            const newContent = newDoc.querySelector('#main-content');

            if (newContent) {
              // Update page title
              const newTitle = newDoc.querySelector('title');
              if (newTitle) {
                document.title = newTitle.textContent;
              }

              // Update URL
              if (addToHistory) {
                history.pushState({ url: url }, '', url);
              }

              // Animate out current content
              await this.animateOutContent();

              // Replace content
              this.mainContent.innerHTML = newContent.innerHTML;

              // Animate in new content
              await this.animateInContent();

              // Update any scripts or dynamic content
              this.updateDynamicContent();
            }
          } catch (error) {
            console.error('Navigation error:', error);
            // Fallback to normal navigation
            window.location.href = url;
          } finally {
            // Hide transition overlay
            this.hideTransition();
            this.isTransitioning = false;
          }
        }

        showTransition() {
          if (this.transition) {
            gsap.to(this.transition, {
              opacity: 1,
              duration: 0.3,
              ease: 'power2.inOut',
            });
          }
        }

        hideTransition() {
          if (this.transition) {
            gsap.to(this.transition, {
              opacity: 0,
              duration: 0.5,
              ease: 'power2.inOut',
            });
          }
        }

        animateOutContent() {
          return new Promise((resolve) => {
            gsap.to(this.mainContent, {
              opacity: 0,
              y: -20,
              duration: 0.4,
              ease: 'power2.in',
              onComplete: resolve,
            });
          });
        }

        animateInContent() {
          return new Promise((resolve) => {
            gsap.fromTo(
              this.mainContent,
              {
                opacity: 0,
                y: 20,
              },
              {
                opacity: 1,
                y: 0,
                duration: 0.6,
                ease: 'power2.out',
                onComplete: () => {
                  this.animateContentElements();
                  resolve();
                },
              }
            );
          });
        }

        updateDynamicContent() {
          // Re-initialize any dynamic content like carousels, animations, etc.
          // This can be extended based on what dynamic elements you have

          // Re-initialize UnicornStudio if present
          if (window.UnicornStudio && typeof UnicornStudio.init === 'function') {
            UnicornStudio.init();
          }

          // Dispatch custom event for other scripts to listen to
          window.dispatchEvent(new CustomEvent('pageTransitionComplete'));
        }
      }

      // Initialize when DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
          new PageTransition();
        });
      } else {
        new PageTransition();
      }
    </script>
  </body>
</html>
